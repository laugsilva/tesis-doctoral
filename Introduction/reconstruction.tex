%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Object reconstruction and event selection
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%

\chapter{Event reconstruction and $b$-Tagging }\label{ch:reco}


The event reconstruction software, which in ATLAS is implemented in the software framework ATHENA, process the events, starting from the raw data obtained from the various sub-detectors (energy deposits and hits), processing them in many different stages and finally interpreting it as a set of charged tracks, electrons, photons, jets, muons and, in general, of possible kinds of final state objects with related four momenta.  
In this chapter the algorithms for the identification of $b$-quark jets are presented.  These algorithms are mainly based on the reconstruction of the primary interaction vertex, on the reconstruction of charged particles in the Inner Detector and on the reconstruction of jets in the calorimeter.   

%------------------------------------------------------------------------
\section{Jet reconstruction and calibration}\label{sec:ObjSelection}
%------------------------------------------------------------------------

Hadronic jets used for ATLAS analyses are reconstructed by a jet algorithm, starting from the energy depositions of electromagnetic and hadronic showers in the calorimeters.  Two different size parameters are used: $R = 0.4$, for narrow jets, and $R = 0.6$, for wider jets. The default jet algorithm is the anti-$kt$ algorithm~\cite{Asquith:1311867}, described in the previous chapter. Due to the expected level of pile-up in the LHC, one of the primary factors that influenced the decision on the jet algorithm was the effect of multiple simultaneous interactions on the reconstruction of jets. The original ATLAS cone algorithm, known to contain infrared and collinear sensitivity, is very susceptible to this effect. On the contrary, the anti-$kt$ algorithm is the most stable after the introduction of pile-up.  

The input to calorimeter jet reconstruction can be calorimeter towers or topological cell clusters. Charged particle tracks reconstructed in the Inner Detectors are also used to define jets. The latter have the further advantage of being insensitive to pile-up and provide a stable reference for systematic studies. The jet inputs are combined as massless four-momentum objects in order to form the final four-momentum of the jet, which allows for a well-defined jet mass~\cite{Busato:1271710}. In the case of track-jets, the track four-momentum is constructed assuming the $\pi$ meson mass for each track.

Calorimeter towers are static, $\Delta \eta \times \Delta \phi = 0.1 \times 0.1$, grid elements built directly from calorimeter cells. There are two types of calorimeter towers: with or without noise supression. The latter are called ``noise-suppressed'' towers and use only the cells with energies above a certain noise threshold.  The noise of a calorimeter cell is measured by recording calorimeter signals in periods where no beam is present in the acelerator.  The standard deviation $\sigma$ around the mean measured energy is interpreted as the noise of the cell, and dependes on the sampling layer in which the cell resides and the position in $\eta$.

The results presented in this thesis show jets which were built from noise-suppressed topological clusters of energy in the calorimeter, aslo known as ``topo-clusters''~\cite{topoClusters}. Topological clusters are groups of calorimeter cells that are designed to follow the shower development taking advantage of the fine segmentataion of the ATLAS calorimeters. The topological cluster formation starts from a seed cell with $|E_{cell}| > 4 \sigma$ above the noise. In a second step, neighbor cells that have an energy at least 2$\sigma$ above their mean noise are added to the cluster. Finally, all nearest-neighbor cells surrounding the clustered cells are added to the cluster, regardless of signal-to-noise ratio\footnote{Noise-supressed towers make use of the topological clusters algorithm~\cite{topoClusters} to select cells, i.e. only calorimeter cells that are included in topo-clusters are used.}. The position of the cluster is assigned as the energy-weighted centroid of all constituent cells (the weight used is the absolute cell energy).

In Monte Carlo simulation, reference jets (``truth jets'') are formed from simulated stable particles using the jet algorithm utilized for the reconstructed jets. 

\subsubsection{Jet calibration}

The purpose of the jet energy calibration, or jet energy scale (JES), is to correct the measured electromagnetic scale (EM-scale) energy to the energy of the stable particles within a jet.  The jet energy calibration must account for the calorimeter non-compensation; the energy lost in inactive regions of the detector, such as in the cryostat walls or cabling; energy that escapes the calorimeters, such as that of highly-energetic particles that “punch-through” to the muon system; energy of cells that are not included in clusters, due to inefficiencies in the noise-suppression scheme; and energy of clusters not included in the final reconstructed jet, due to inefficiencies in the jet reconstruction algorithm. The muons and neutrinos that may be present within the jet are not expected to interact within the calorimeters, and are not included in this energy calibration.
Due to the varying calorimeter coverage, detector technology, and amount of upstream inactive material, the calibration that must be applied to each jet to bring it to the hadronic scale varies with its $\eta$ position within the detector. 

The jet energy is first reconstructed from the constituent cell energies at EM-scale. These cells have been calibrated to return the energy corresponding to electromagnetic showers in the calorimeter, based on test-beam injection of electrons and pions~\cite{Aharrouche2006601} and measurements of cosmic muons~\cite{Cooke:1071187} and the reconstruction of the $Z$ mass peak in $Z \rightarrow ee$ decays~\cite{Aad:2011mk}. The correction for the lower response to hadrons is based on the topology of the energy depositions observed in the calorimeter. 

In the simplest case the measured jet energy is corrected, on average, using Monte Carlo simulations, as follows:
%
\begin{equation}
E^{jet}_{calib} = E^{jet}_{meas} / \emph{F}_{calib}(E^{jet}_{meas}),   \mbox{with  }   E^{jet}_{meas} = E^{jet}_{EM} - \emph{O}(\mbox{NPV}),
\end{equation}
%
where $E^{jet}_{EM}$ is the calorimeter energy measured at the electromagnetic scale, $E^{jet}_{calib}$ is the calibrated energy and $\emph{F}_{calib}$ is the calibration function that depends on the measured jet energy and is evaluated in small jet $\eta$ regions. The variable $ \emph{O}(NPV)$ denotes the correction for additional energy from multiple proton-proton interactions depending on the number of primary vertices (NPV).

The simplest calibration scheme, the so called ``EM+JES'', applies the corrections as a function of the jet energy and pseudorapidity to jets reconstructed at the electromagnetic scale.  The additional energy due to multiple proton-proton collisions within the same bunch crossing (pile-up) is corrected before the hadronic energy scale is restored, such that the derivation of the jet energy scale calibration is factorised and does not depend on the number of additional interactions in the event. The EM+JES calibration scheme consists of three subsequent stops:

\begin{itemize}
\item
Pile-up correction: An offset correction is applied in order to substract the additional average energy measured in the calorimeter due to multiple proton-proton interactions. This correction is derived from minimum bias data as a function of NPV, the jet pseudorapidity and the bunch spacing.
\item
Vertex correction: The jet four momentum is corrected such that the jet originates from the primary vertex of the interaction instead of the geometrical centre of the detector. 
\item
Jet energy and direction correction: The jet energy and direction are corrected using constants derived from the comparison of the kinematic observables of reconstructed jets and those from truth jets in the simulation.

The final step the calibration is derived in terms of the energy response of the jet, or the ratio of the reconstructed jet energy to that of a truth jet. 

Other calibrations schemes are the global calorimeter cell weighting (GCW) calibration and the local cluster weighting (LCW) calibration.  The GCW scheme exploits the observation that electromagnetic showers in the calorimeter leave more compact energy depositions than hadronic showers with the same energy.  Energy corrections are derived for each cell within a jet.  The cell corrections account for all energy loses of a jet in the detector. Since these corrections are only applicable to jets and not to energy depositions, they are called ``global'' corrections.

The LCW calibration method first classifies topo-clusters as either electromagnetic of hadronic, based on the measured energy density. Energy corrections are derived according to this classification from single charged and neutral pion Monte Carlo simulations. Dedicated corrections are derived for the effects of non-compensation, signal losses due to noise threshold effects, and energy lost in non-instrumented regions. Since the energy corrections are applied without reference to a jet definition they are called ``local'' corrections. Jets are then built from these calibrated clusters using a jet algorithm.  

The final jet energy calibration (see equation above) can be applied to EM scale jets, with the resulting calibrated jets referred to as EM+JES, or to LCW (GCW) calibrated jets, with the resulting jets referred to as LCW+JES (GCW+JES) jets.

A further jet calibration scheme called global sequential (GS) calibration, starts from jets calibrated with the EM+JES calibration and exploits the topology of the energy deposits in the calorimeter to characterise fluctuations in the jet particle content of the hadronic shower development.  Correcting for such fluctuations can improve the jet energy resolution. The correction uses several jet properties, and each correction is applied sequentially.


For the 2011 data the recomended calibration schemes were the EM+JES and the LCW calibrations. The simple EM+JES calibration does not provide the best performance, but allows in the central detector region the most direct evaluation of the systematic uncertainties from the calorimeter response to single isolated hadron measured $in situ$ and in test-beams and from systematic variations in the Monte Carlo simulation.  For the LCW+JES calibration scheme the JES uncertainty is determined from $in situ$ techniques. For all calibration schemes, the JES uncertainty in the forward regions is derived from the uncertainty in the central region using the transverse momentum balance in events where only two jets are produced. 


%-------------------------------------------------------------------
\section{ $\bm b$-jet Tagging}\label{sec:btagging}
%------------------------------------------------------------------------


%From Gbb note
Jets are classified as $b$-quark candidates by the ATLAS MV1 $b$-tagging algorithm, based on a neural network that combines the information from three high-performance taggers: IP3D, SV1 and JetFitter \cite{ATLAS-CONF-2011-102}.  These three tagging algorithms use a likelihood ratio technique in which input variables are compared to smoothed normalized distributions for both the $b$- and background (light- or in some cases $c$-jet) hypotheses, obtained from Monte Carlo simulation.  The IP3D tagger takes advantage of the signed transverse and longitudinal impact parameter significances. The SV1 tagger reconstructs an inclusive vertex formed by the decay products of the $b$-hadron and relies on the invariant mass of all tracks associated to the vertex, the ratio of the sum of the energies of the tracks in the vertex to the sum of the energies of all tracks in the jet and the number of two-track vertices. The JetFitter tagger exploits the topology of the primary, $b$- and $c$-vertices and combines vertex variables with the flight length significance.  The $b$-tagging performance is determined using a simulated $t\bar{t}$ sample and is calibrated using experimental data with jets containing muons and with a sample of $t\bar{t}$ events~\cite{ATLAS-CONF-2011-089}.



%From https://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/CONFNOTES/ATLAS-CONF-2011-102/

The ability to identify jets containing $b$-hadrons is important for the high-$\pt$ physics program of a general-purpose experiment at the LHC such as ATLAS. Two robust $b$-tagging algorithms taking advantage of the impact parameter of tracks (JetProb) or reconstructing secondary vertices (SV0) have been quickly commisssioned~\cite{ATLAS-CONF-2010-091}\cite{ATLAS-CONF-2010-042} and used for several analyses of the 2012 and 2011 data (REFERENCIAS).
Building on this success, more advanced $b$-tagging algorithms have been commissioned with the 2011 data. All these algorithms are based on Monte Carlo predictions for the signal ($b$-jet) or background (light- or in some cases $c$-jet) hypotheses.

The $b$-tagging performance relies criticaly on the accurate reconstruction of the charged tracks in the ATLAS Inner Detector. 
The innermost part, the pixel detector, has an intrinsic measurement accuracy of around 10~$\mu$m in the transverse plane, and 115~$\mu$m along the beam axis ($z$).  For a central track with $\pt=$5~GeV, which is typical for $b$-tagging, the transverse momentum resolution is around 75~MeV and the transverse impact parameter resolutioni is about 35~$\mu$m.

\subsection{Primary vertex reconstruction}

The knowledge of the position of the primary interaction point (primary vertex) of the proton-proton collision is important for $b$-tagging since it defines the reference point with respect to which impact parameters and vertex displacements are measured.

See primary vertex recontruction in~\cite{ATLAS-CONF-2010-069}.

%\subsection{Pile-up}

Out-of-time pile-up events ($pp$ collisions from neighboring bunches in the same train) also generate calorimeter activity and consequently extra jets. However, given the time resolution of the Inner Detector, and since the $b$-tagging algorithms reject jets with no track associtaed to them, the contribution of the out-of-time pile-up for this analysis is expected to be negligible.




%------------------------------------------------------------------------
\subsection{Tracks selection and properties}\label{sec:ObjSelection}
%------------------------------------------------------------------------

\subsubsection{Track quality cuts}


The track selection for $b$-tagging is designed to select well-measured tracks rejecting fake tracks and tracks from long-lived particles ($K_s$, $\Lambda$, and other hyperon decays, generically referred to as $V^0$ decays) and material description.

The tracks of charged particles with a pseudorapidity $|\eta| < 2.5$ are reconstructed in the the Inner Detector. It is composed of a barrel, consisting of 3 Pixel layers, 4 double layers of single-sided silicon strip sensors, and 73 layers of Transition Radiation Tracker straws concentric with the beam, plus a system of disks on each end of the barrel, occupying in total a cylindrical volume around the interaction point of radius of 1.15~m and length of 7.024~m. The Pixel detector's innermost layer is located at a radius of 5 cm from the beam axis, has a position resolution of approximately 10~$\mu$m in the $r-\phi$ plane and 115 $\mu$m along the beam axis ($z$). %Tracks with $p^{\rm{track}}_{\rm{T}} > 150$
%Tracks with $p^{\rm{track}}_{\rm{T}} > 400$ MeV and consistent with the beamspot are associated in primary vertices via a finding/fitting sequential algorithm. Several primary vertices can be reconstructed per event due to the presence of in-time pile-up. The one with at least five associated tracks, a $z$ position within 100~mm of the ATLAS geometrical center, and the largest $\sum_{\rm trk}\pt^2$, is selected as the one associated to the hard interaction.
%are selected as good vertices.


\subsubsection{Track association to jets}

The actual tagging is performed on the sub-set of tracks in the event that are associated to the jets. Tracks are associtaed to the jets with a spatial matching in $\Delta R_{(jet,track)}$. The association cut $\Delta R$ is varied as a function of the jet $\pt$ in order to have a smaller cone for high-$pt$ jets which are more collimated.




\subsubsection{Impact parameters}
The most critical track parameters for $b$-tagging are the transverse and longitudinal impact parameters. The transverse parameter $d_0$ is the distance of closest approach of the track to the primary vertex point in the $r\phi$ projection. The $z$ coordinate of the track at this point of closest approach is referred to as $z_0$. It is often called the longitudinal impact parameter\footnote{Stricktly speaking the impact parameter is $|z_0|sin\theta$, where $\theta$ is the polar angle of the track.}. On the basis that the decay point of the $b$-hadron must lie along its flight path, the impact parameter is signed to further discriminate the tracks from $b$-hadron decays from tracks originating from the primary vertex. The sign is positive if the track extrapolation crosses the jet direction in front of the primary vertex, and negative otherwise. Therefore, tracks from $b/c$ hadron decays tend to have positive sign.

The significance, which gives more weight to tracks measured precisely, is the main ingredient of the tagging algorithms based on impact parameters.

\subsection{$b$-tagging algorithms}

%A first stag
